{"ast":null,"code":"import{__values}from\"tslib\";import{Subscription}from'../Subscription';import{operate}from'../util/lift';import{innerFrom}from'../observable/innerFrom';import{createOperatorSubscriber}from'./OperatorSubscriber';import{noop}from'../util/noop';import{arrRemove}from'../util/arrRemove';export function bufferToggle(openings,closingSelector){return operate(function(source,subscriber){var buffers=[];innerFrom(openings).subscribe(createOperatorSubscriber(subscriber,function(openValue){var buffer=[];buffers.push(buffer);var closingSubscription=new Subscription();var emitBuffer=function emitBuffer(){arrRemove(buffers,buffer);subscriber.next(buffer);closingSubscription.unsubscribe();};closingSubscription.add(innerFrom(closingSelector(openValue)).subscribe(createOperatorSubscriber(subscriber,emitBuffer,noop)));},noop));source.subscribe(createOperatorSubscriber(subscriber,function(value){var e_1,_a;try{for(var buffers_1=__values(buffers),buffers_1_1=buffers_1.next();!buffers_1_1.done;buffers_1_1=buffers_1.next()){var buffer=buffers_1_1.value;buffer.push(value);}}catch(e_1_1){e_1={error:e_1_1};}finally{try{if(buffers_1_1&&!buffers_1_1.done&&(_a=buffers_1.return))_a.call(buffers_1);}finally{if(e_1)throw e_1.error;}}},function(){while(buffers.length>0){subscriber.next(buffers.shift());}subscriber.complete();}));});}","map":{"version":3,"names":["Subscription","operate","innerFrom","createOperatorSubscriber","noop","arrRemove","bufferToggle","openings","closingSelector","source","subscriber","buffers","subscribe","openValue","buffer","push","closingSubscription","emitBuffer","next","unsubscribe","add","value","buffers_1","__values","buffers_1_1","done","length","shift","complete"],"sources":["/Users/jawaadahmar/Desktop/atlas-clothing/client/src/thistle-lion/node_modules/rxjs/src/internal/operators/bufferToggle.ts"],"sourcesContent":["import { Subscription } from '../Subscription';\nimport { OperatorFunction, ObservableInput } from '../types';\nimport { operate } from '../util/lift';\nimport { innerFrom } from '../observable/innerFrom';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { noop } from '../util/noop';\nimport { arrRemove } from '../util/arrRemove';\n\n/**\n * Buffers the source Observable values starting from an emission from\n * `openings` and ending when the output of `closingSelector` emits.\n *\n * <span class=\"informal\">Collects values from the past as an array. Starts\n * collecting only when `opening` emits, and calls the `closingSelector`\n * function to get an Observable that tells when to close the buffer.</span>\n *\n * ![](bufferToggle.png)\n *\n * Buffers values from the source by opening the buffer via signals from an\n * Observable provided to `openings`, and closing and sending the buffers when\n * a Subscribable or Promise returned by the `closingSelector` function emits.\n *\n * ## Example\n *\n * Every other second, emit the click events from the next 500ms\n *\n * ```ts\n * import { fromEvent, interval, bufferToggle, EMPTY } from 'rxjs';\n *\n * const clicks = fromEvent(document, 'click');\n * const openings = interval(1000);\n * const buffered = clicks.pipe(bufferToggle(openings, i =>\n *   i % 2 ? interval(500) : EMPTY\n * ));\n * buffered.subscribe(x => console.log(x));\n * ```\n *\n * @see {@link buffer}\n * @see {@link bufferCount}\n * @see {@link bufferTime}\n * @see {@link bufferWhen}\n * @see {@link windowToggle}\n *\n * @param openings A Subscribable or Promise of notifications to start new\n * buffers.\n * @param closingSelector A function that takes\n * the value emitted by the `openings` observable and returns a Subscribable or Promise,\n * which, when it emits, signals that the associated buffer should be emitted\n * and cleared.\n * @return A function that returns an Observable of arrays of buffered values.\n */\nexport function bufferToggle<T, O>(\n  openings: ObservableInput<O>,\n  closingSelector: (value: O) => ObservableInput<any>\n): OperatorFunction<T, T[]> {\n  return operate((source, subscriber) => {\n    const buffers: T[][] = [];\n\n    // Subscribe to the openings notifier first\n    innerFrom(openings).subscribe(\n      createOperatorSubscriber(\n        subscriber,\n        (openValue) => {\n          const buffer: T[] = [];\n          buffers.push(buffer);\n          // We use this composite subscription, so that\n          // when the closing notifier emits, we can tear it down.\n          const closingSubscription = new Subscription();\n\n          const emitBuffer = () => {\n            arrRemove(buffers, buffer);\n            subscriber.next(buffer);\n            closingSubscription.unsubscribe();\n          };\n\n          // The line below will add the subscription to the parent subscriber *and* the closing subscription.\n          closingSubscription.add(innerFrom(closingSelector(openValue)).subscribe(createOperatorSubscriber(subscriber, emitBuffer, noop)));\n        },\n        noop\n      )\n    );\n\n    source.subscribe(\n      createOperatorSubscriber(\n        subscriber,\n        (value) => {\n          // Value from our source. Add it to all pending buffers.\n          for (const buffer of buffers) {\n            buffer.push(value);\n          }\n        },\n        () => {\n          // Source complete. Emit all pending buffers.\n          while (buffers.length > 0) {\n            subscriber.next(buffers.shift()!);\n          }\n          subscriber.complete();\n        }\n      )\n    );\n  });\n}\n"],"mappings":"4BAAA,OAASA,YAAY,KAAQ,iBAAiB,CAE9C,OAASC,OAAO,KAAQ,cAAc,CACtC,OAASC,SAAS,KAAQ,yBAAyB,CACnD,OAASC,wBAAwB,KAAQ,sBAAsB,CAC/D,OAASC,IAAI,KAAQ,cAAc,CACnC,OAASC,SAAS,KAAQ,mBAAmB,CA6C7C,MAAM,SAAU,CAAAC,YAAYA,CAC1BC,QAA4B,CAC5BC,eAAmD,EAEnD,MAAO,CAAAP,OAAO,CAAC,SAACQ,MAAM,CAAEC,UAAU,EAChC,GAAM,CAAAC,OAAO,CAAU,EAAE,CAGzBT,SAAS,CAACK,QAAQ,CAAC,CAACK,SAAS,CAC3BT,wBAAwB,CACtBO,UAAU,CACV,SAACG,SAAS,EACR,GAAM,CAAAC,MAAM,CAAQ,EAAE,CACtBH,OAAO,CAACI,IAAI,CAACD,MAAM,CAAC,CAGpB,GAAM,CAAAE,mBAAmB,CAAG,GAAI,CAAAhB,YAAY,EAAE,CAE9C,GAAM,CAAAiB,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAA,CAAG,CACjBZ,SAAS,CAACM,OAAO,CAAEG,MAAM,CAAC,CAC1BJ,UAAU,CAACQ,IAAI,CAACJ,MAAM,CAAC,CACvBE,mBAAmB,CAACG,WAAW,EAAE,CACnC,CAAC,CAGDH,mBAAmB,CAACI,GAAG,CAAClB,SAAS,CAACM,eAAe,CAACK,SAAS,CAAC,CAAC,CAACD,SAAS,CAACT,wBAAwB,CAACO,UAAU,CAAEO,UAAU,CAAEb,IAAI,CAAC,CAAC,CAAC,CAClI,CAAC,CACDA,IAAI,CACL,CACF,CAEDK,MAAM,CAACG,SAAS,CACdT,wBAAwB,CACtBO,UAAU,CACV,SAACW,KAAK,E,eAEJ,IAAqB,IAAAC,SAAA,CAAAC,QAAA,CAAAZ,OAAO,EAAAa,WAAA,CAAAF,SAAA,CAAAJ,IAAA,IAAAM,WAAA,CAAAC,IAAA,CAAAD,WAAA,CAAAF,SAAA,CAAAJ,IAAA,GAAE,CAAzB,GAAM,CAAAJ,MAAM,CAAAU,WAAA,CAAAH,KAAA,CACfP,MAAM,CAACC,IAAI,CAACM,KAAK,CAAC,C,4JAEtB,CAAC,CACD,WAEE,MAAOV,OAAO,CAACe,MAAM,CAAG,CAAC,CAAE,CACzBhB,UAAU,CAACQ,IAAI,CAACP,OAAO,CAACgB,KAAK,EAAG,CAAC,C,CAEnCjB,UAAU,CAACkB,QAAQ,EAAE,CACvB,CAAC,CACF,CACF,CACH,CAAC,CAAC,CACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}